<!DOCTYPE html>
<html>
<head>
	<title>Chatty</title>
</head>
	<body>
		
		<div id="alias">
			<p>Choose an alias</p>
			<p id="aliasError"></p>
			<form id="setAlias">
				<input id="aliasBox" size="50"/>
				<input type="submit"/>				
			</form>
		</div>
		
		<div id="container">
			<div id="aliasContainer"></div>
			<div id="messageContainer">
				<ul id="messages"></ul>
				<form id="messageForm">
					<input id="messageBox" size="50"/>
					<input type="submit"/>
				</form>
			</div>
		</div>
		<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
  		<script src="/socket.io/socket.io.js"></script>
		<script>
			var socket = io();

			$('#setAlias').submit(function () {
				socket.emit('new user', $('#aliasBox').val(), function (data) {
					if (data) {
							$('#alias').hide();
							$('#container').show();
					} else {
						$('#aliasError').html('Oops, that name\'s already taken, try a new one');
					}
				});
				$('#aliasBox').val('');
			});

			$(function () {
		  		$('#messageForm').submit(function (){
	      			socket.emit('chat message', $('#messageBox').val());
	      			$('#messageBox').val('');
	      			return false;
    			});
    			socket.on('new message', function (msg){
      				$('#messages').append($('<li>').text(msg));
    			});
			});
		</script>
	</body>
	<style type="text/css">
		#container {
			display: none;
		}
		#messageContainer {
			float: right;
			border: 1px #000 solid;
		}
		#chatDisplay {
			height: 250px;
		}
		#messages { 
			list-style-type: none; 
			margin: 0; 
			padding: 0; 
		}
      	#messages li { 
      		padding: 5px 10px; 
      	}
      	#messages li:nth-child(odd) { 
      		background: #eee; 
      	}	
	</style>
</html>